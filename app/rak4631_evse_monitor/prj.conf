#
# Copyright (c) 2023 Nordic Semiconductor ASA
#
# SPDX-License-Identifier: LicenseRef-Nordic-5-Clause
#

CONFIG_STATIC_INIT_GNU=y

# Config Peripherals
CONFIG_GPIO=y
CONFIG_PWM=y
CONFIG_FLASH=y
CONFIG_SPI=y
CONFIG_NRFX_SPI1=y
CONFIG_NRFX_SPI2=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_NVS=y
CONFIG_NVS_LOG_LEVEL_DBG=n
CONFIG_MPU_ALLOW_FLASH_WRITE=y

# ADC for EVSE sensors
CONFIG_ADC=y
CONFIG_ADC_NRFX_SAADC=y

# Sidewalk
CONFIG_SIDEWALK=y
CONFIG_SMF=y
CONFIG_SIDEWALK_DFU=n
# PSA key storage — re-enabled after re-provisioning MFG keys.
# Private keys live in PSA (encrypted with HUK), not in plaintext flash.
# If HUK is lost (chip erase), re-flash mfg.hex then app to re-import keys.
CONFIG_SIDEWALK_CRYPTO_PSA_KEY_STORAGE=y
CONFIG_SIDEWALK_THREAD_PRIORITY=10
CONFIG_SIDEWALK_NRFX_SPI1=y

# Logging
CONFIG_LOG=y
CONFIG_LOG_DEFAULT_LEVEL=3
CONFIG_LOG_MODE_IMMEDIATE=y
CONFIG_SIDEWALK_LOG_LEVEL_INF=y
# Crypto logging: set to DBG for handshake debugging, INF for normal use
CONFIG_SIDEWALK_CRYPTO_LOG_LEVEL_INF=y

# Buttons and LEDs
CONFIG_DK_LIBRARY=y

# Bluetooth
CONFIG_BT_DEVICE_NAME="EVSE Monitor"

# Debug
CONFIG_RESET_ON_FATAL_ERROR=n

# Shell and USB CDC console
CONFIG_USB_DEVICE_STACK=y
CONFIG_USB_DEVICE_VID=0x2FE9
CONFIG_USB_DEVICE_PRODUCT="RAK_EVSE"
CONFIG_USB_CDC_ACM_LOG_LEVEL_OFF=y
CONFIG_UART_LINE_CTRL=y
CONFIG_USB_CDC_ACM_RINGBUF_SIZE=512
CONFIG_SHELL=y
CONFIG_SHELL_LOG_BACKEND=y
CONFIG_SHELL_BACKEND_SERIAL_CHECK_DTR=y
CONFIG_REBOOT=y

# Power Management
CONFIG_PM_DEVICE=y

# CRC library (for OTA update CRC32/CRC16 validation)
CONFIG_CRC=y

# Heartbeat period — 60s periodic uplink even when no sensor changes
CONFIG_SID_END_DEVICE_NOTIFY_DATA_PERIOD_MS=60000

# ED25519 signature verification for OTA signing (PSA Crypto / Oberon backend)
# CC310 does not support Ed25519; Oberon provides the software implementation.
CONFIG_PSA_WANT_ALG_PURE_EDDSA=y
CONFIG_PSA_WANT_ECC_TWISTED_EDWARDS_255=y
CONFIG_PSA_WANT_KEY_TYPE_ECC_PUBLIC_KEY=y

# Reserve last 8KB of SRAM for app image
CONFIG_SRAM_SIZE=248
